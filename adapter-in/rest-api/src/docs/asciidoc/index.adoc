= CrawlingHub REST API Documentation
:doctype: book
:icons: font
:source-highlighter: highlightjs
:toc: left
:toclevels: 3
:sectlinks:

[[overview]]
== 개요

CrawlingHub REST API 문서입니다.
이 문서는 Spring REST Docs를 사용하여 테스트 기반으로 자동 생성됩니다.

[[overview-http-verbs]]
=== HTTP 메서드

RESTful 서비스에서 사용하는 HTTP 메서드:

|===
| 메서드 | 용도

| `GET`
| 리소스 조회

| `POST`
| 리소스 생성

| `PATCH`
| 리소스 부분 수정

| `DELETE`
| 리소스 삭제
|===

[[overview-http-status-codes]]
=== HTTP 상태 코드

|===
| 상태 코드 | 설명

| `200 OK`
| 요청 성공

| `201 Created`
| 리소스 생성 성공

| `400 Bad Request`
| 잘못된 요청 (유효성 검증 실패)

| `401 Unauthorized`
| 인증 필요

| `403 Forbidden`
| 권한 없음

| `404 Not Found`
| 리소스를 찾을 수 없음

| `500 Internal Server Error`
| 서버 내부 오류
|===

[[overview-response-format]]
=== 공통 응답 형식

==== 성공 응답

모든 성공 API 응답은 다음과 같은 형식을 사용합니다:

[source,json]
----
{
  "data": { ... },
  "timestamp": "2025-12-22T10:30:00.000Z",
  "requestId": "550e8400-e29b-41d4-a716-446655440000"
}
----

|===
| 필드 | 타입 | 설명

| `data`
| Object
| 응답 데이터 (null 가능)

| `timestamp`
| String
| ISO 8601 형식 응답 시각

| `requestId`
| String
| UUID 형식 요청 ID
|===

==== 에러 응답 (RFC 7807 ProblemDetail)

에러 발생 시 RFC 7807 표준을 따르는 ProblemDetail 형식으로 응답합니다:

[source,json]
----
{
  "type": "about:blank",
  "title": "Bad Request",
  "status": 400,
  "detail": "유효성 검증에 실패했습니다.",
  "code": "VALIDATION_ERROR",
  "timestamp": "2025-12-22T10:30:00.000Z",
  "instance": "/api/v1/crawling/sellers",
  "errors": [
    {
      "field": "siteUrl",
      "message": "사이트 URL은 필수입니다."
    }
  ]
}
----

|===
| 필드 | 타입 | 설명

| `type`
| String
| 에러 타입 URI (기본값: "about:blank")

| `title`
| String
| HTTP 상태 설명

| `status`
| Integer
| HTTP 상태 코드

| `detail`
| String
| 에러 상세 메시지

| `code`
| String
| 애플리케이션 에러 코드

| `timestamp`
| String
| ISO 8601 형식 에러 발생 시각

| `instance`
| String
| 에러가 발생한 요청 경로

| `errors`
| Array
| (선택) 필드별 유효성 검증 에러 목록
|===

[[overview-authentication]]
=== 인증

모든 API는 JWT 토큰 기반 인증을 사용합니다.

[source,http]
----
Authorization: Bearer {jwt-token}
----

[[overview-permissions]]
=== 권한

API별로 필요한 권한이 정의되어 있습니다. 권한 체계:

|===
| 권한 | 설명

| `dashboard:read`
| 대시보드 통계 조회

| `seller:read`
| 셀러 조회

| `seller:write`
| 셀러 등록/수정

| `schedule:read`
| 스케줄러 조회

| `schedule:write`
| 스케줄러 등록/수정/트리거

| `task:read`
| 태스크 조회

| `task:write`
| 태스크 재시도

| `execution:read`
| 실행 결과 조회

| `useragent:read`
| UserAgent 조회

| `useragent:write`
| UserAgent 복구

| `product:read`
| 상품 조회

| `product:write`
| 상품 동기화

| `outbox:read`
| Outbox 조회

| `outbox:write`
| Outbox 재발행/재시도
|===

// ============================================
// API 도메인별 문서 Include
// ============================================

include::dashboard.adoc[]

include::seller.adoc[]

include::schedule.adoc[]

include::task.adoc[]

include::execution.adoc[]

include::useragent.adoc[]

include::crawled-product.adoc[]

include::product-outbox.adoc[]

include::outbox.adoc[]

include::webhook.adoc[]
